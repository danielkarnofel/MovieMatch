<!DOCTYPE html>
<html>
<%- include('partials/head.ejs') %>
<body>
<%- include('partials/header.ejs') %>

<main>

  <section>
    <h1>Welcome to MovieMatch</h1>
    <div class="hero-text">
      <p>Discover movies that match your mood — whether you're feeling adventurous, emotional, or just need a feel-good escape.</p>
      <p>Explore, rate, and save films that vibe with you. Your next favorite movie is just a mood away.</p>
    </div>
  </section>

  <section>
    <h1>Your Top Pick</h1>
    <% const topPick = popularMovies.results[0]; %>
    <div class="highlight">
      <img src="http://image.tmdb.org/t/p/w154<%= topPick.poster_path %>" alt="<%= topPick.title %>">
      <div>
        <h3><%= topPick.title %></h3>
        <p><%= topPick.overview %></p>
      </div>
    </div>
  </section>

  <section>
    <h1>Recommended Moods</h1>
    <div class="mood-container">
      <% moods.forEach(mood => { %>
        <a href="/mood/<%= mood.id %>"><%= mood.name %></a>
      <% }) %>
    </div>
  </section>

  <section>
    <h1>Quote of the Day</h1>
    <div class="quote">
      <p>“<%= quoteOfTheDay.content %>”<br><em>― <%= quoteOfTheDay.author %></em></p>
    </div>
  </section>

  <section>
    <h1>Trending Movies</h1>
    <div class="gallery">
      <% for (let i = 0; i < 7; i++) { %>
        <% const movie = trendingMovies.results[i]; %>
        <% if (movie && movie.poster_path) { %>
          <div class="gallery-item">
            <a href="/movie/<%= movie.id %>">
              <img src="http://image.tmdb.org/t/p/w154<%= movie.poster_path %>" alt="<%= movie.title %>">
            </a>
          </div>
        <% } %>
      <% } %>
    </div>
  </section>

  <% 
    const lists = {};
    userListsWithMovies.forEach(row => {
      if (!lists[row.list_name]) lists[row.list_name] = [];
      if (row.poster_url) lists[row.list_name].push(row);
    });
  %>

  <% Object.keys(lists).forEach(listName => { %>
    <section>
      <h2><%= listName %></h2>
      <div class="gallery">
        <% lists[listName].forEach(movie => { %>
          <div class="gallery-item">
            <a href="/movie?title=<%= encodeURIComponent(movie.movie_title) %>&poster=<%= movie.poster_url %>">
                <img src="<%= movie.poster_url %>" alt="<%= movie.movie_title %>">
            </a>

          </div>
        <% }) %>
      </div>
    </section>
  <% }) %>

</main>

<%- include('partials/footer.ejs') %>
</body>
</html>
