<!DOCTYPE html>
<html>
<%- include("partials/head.ejs") %>
<body>
<%- include("partials/header.ejs") %>

<main>
  <% if (typeof flash !== 'undefined') { %>
    <div class="alert alert-success"><%= flash %></div>
  <% } %>

  <h1>Hi <%= username %>!</h1>
  <p><strong>Email:</strong> <%= email %></p>

  <form action="/api/lists" method="POST">
    <input type="text" name="list_name" placeholder="New list name" required>
    <textarea name="description" placeholder="Description (optional)"></textarea>
    <button type="submit">Create List</button>
  </form>

  <h2>My Lists</h2>
  <% if (!userLists || userLists.length === 0) { %>
    <p>No lists yet.</p>
  <% } else { %>
    <% userLists.forEach(list => { %>
      <section>
        <h3><%= list.list_name %></h3>
        <p><%= list.description %></p>
        <a href="/list/<%= list.list_id %>">View List</a>
        <form action="/api/lists/delete/<%= list.list_id %>" method="POST" style="display:inline;">
          <button type="submit" onclick="return confirm('Delete this list?')">Delete</button>
        </form>
        <form action="/list/<%= list.list_id %>" style="display:inline;">
          <button type="submit">Movies</button>
        </form>
      </section>
    <% }) %>
  <% } %>
</main>

<%- include("partials/footer.ejs") %>
</body>
</html>
