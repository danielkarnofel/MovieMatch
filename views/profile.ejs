<!DOCTYPE html>
<html>
<%- include("partials/head.ejs") %>
<body>
<%- include("partials/header.ejs") %>

<main>
  <% if (typeof flash !== 'undefined') { %>
    <div class="alert alert-success"><%= flash %></div>
  <% } %>

  <section>
  <h1>Hi <%= username %>!</h1>
  <p><strong>Email:</strong> <%= email %></p>
  </section>

  <section class="lists-container">
  <h2>My Lists</h2>

  <form action="/api/lists" method="POST">
    <input type="text" name="list_name" placeholder="New list name" required>
    <textarea name="description" placeholder="Description (optional)"></textarea>
    <button type="submit">Create List</button>
  </form>

  <% if (!userLists || userLists.length === 0) { %>
    <p>No lists yet.</p>
  <% } else { %>
    <% userLists.forEach(list => { %>
      <div class="list">
        <h3><%= list.list_name %></h3>
        <p><%= list.description %></p>
        <a href="/list/<%= list.list_id %>">View List</a>
        <form action="/api/lists/delete/<%= list.list_id %>" method="POST" style="display:inline;">
          <button type="submit" onclick="return confirm('Delete this list?')">Delete</button>
        </form>
      </div>
    <% }) %>
  <% } %>

  </section>

</main>

<%- include("partials/footer.ejs") %>
</body>
</html>
